<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="/css/tailwind.min.css">
    <script src="https://cdn.tailwindcss.com"></script>
    <title>Inventario de Sacos - AgroSistema</title>
</head>
<body class="bg-gray-50">
    <%- include('../partials/navbar') %>

    <div class="container mx-auto p-6">
        <h2 class="text-3xl font-extrabold text-gray-800 mb-6 text-center">üì¶ Inventario de Sacos</h2>

        <div class="bg-white p-6 rounded-xl shadow-lg mb-8 border-t-8 border-emerald-500">
            <h3 class="text-lg font-bold mb-4 text-emerald-700">‚ûï Registrar Stock</h3>
            <form action="/sacos" method="POST" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                <div>
                    <label class="block text-xs font-bold text-emerald-800 mb-1">PRODUCTO / RUBRO</label>
                    <select id="selectProducto" name="tipoProducto" class="w-full border-2 p-2.5 rounded-lg outline-none focus:border-emerald-500 bg-white" required>
                        <option value="" selected disabled>Elija un producto...</option>
                        <option value="Ma√≠z Amarillo">Ma√≠z Amarillo</option>
                        <option value="Arroz Blanco">Arroz Blanco</option>
                        <option value="Sorg√≥">Sorg√≥</option>
                        <option value="Girasol">Girasol</option>
                        <option value="Soya">Soya</option>
                        <option value="Frijol">Frijol</option>
                        <option value="Caraota">Caraota</option>
                        <option value="Caf√©">Caf√©</option>
                        <option value="Cacao">Cacao</option>
                        <option value="Trigo">Trigo</option>
                    </select>
                </div>

                <div>
                    <label class="block text-xs font-bold text-emerald-800 mb-1">C√ìDIGO DE LOTE</label>
                    <input type="text" id="inputCodigo" name="codigoSaco" class="w-full border-2 p-2.5 rounded-lg bg-gray-100 font-mono font-bold text-emerald-700" readonly placeholder="Autom√°tico">
                </div>

                <div>
                    <label class="block text-xs font-bold text-emerald-800 mb-1">CANTIDAD (SACOS)</label>
                    <input type="number" name="cantidadDisponible" class="w-full border-2 p-2.5 rounded-lg outline-none focus:border-emerald-500" required>
                </div>

                <div>
                    <label class="block text-xs font-bold text-emerald-800 mb-1">PESO (KG)</label>
                    <input type="number" name="pesoNetoKg" class="w-full border-2 p-2.5 rounded-lg outline-none focus:border-emerald-500" placeholder="40">
                </div>

                <div class="md:col-span-2 lg:col-span-2">
                    <label class="block text-xs font-bold text-emerald-800 mb-1">ESTADO / UBICACI√ìN</label>
                    <select name="ubicacion" class="w-full border-2 p-2.5 rounded-lg bg-white outline-none focus:border-emerald-500" required>
                        <option value="" disabled selected>Seleccione el estado...</option>
                        <option value="Amazonas">Amazonas</option><option value="Anzo√°tegui">Anzo√°tegui</option>
                        <option value="Apure">Apure</option><option value="Aragua">Aragua</option>
                        <option value="Barinas">Barinas</option><option value="Bol√≠var">Bol√≠var</option>
                        <option value="Carabobo">Carabobo</option><option value="Cojedes">Cojedes</option>
                        <option value="Delta Amacuro">Delta Amacuro</option><option value="Distrito Capital">Distrito Capital</option>
                        <option value="Falc√≥n">Falc√≥n</option><option value="Gu√°rico">Gu√°rico</option>
                        <option value="Lara">Lara</option><option value="M√©rida">M√©rida</option>
                        <option value="Miranda">Miranda</option><option value="Monagas">Monagas</option>
                        <option value="Nueva Esparta">Nueva Esparta</option><option value="Portuguesa">Portuguesa</option>
                        <option value="Sucre">Sucre</option><option value="T√°chira">T√°chira</option>
                        <option value="Trujillo">Trujillo</option><option value="Vargas">La Guaira (Vargas)</option>
                        <option value="Yaracuy">Yaracuy</option><option value="Zulia">Zulia</option>
                    </select>
                </div>

                <button type="submit" class="md:col-span-3 bg-emerald-600 text-white p-4 rounded-xl font-bold hover:bg-emerald-700 shadow-md transition uppercase">Registrar Inventario</button>
            </form>
        </div>

        <div class="bg-white rounded-xl shadow-lg overflow-hidden border border-gray-200">
            <table class="w-full text-left">
                <thead class="bg-gray-800 text-white uppercase text-xs">
                    <tr>
                        <th class="p-4">C√≥digo</th>
                        <th class="p-4">Producto</th>
                        <th class="p-4 text-center">Stock</th>
                        <th class="p-4 text-center">Peso</th>
                        <th class="p-4">Estado</th>
                        <th class="p-4 text-center">Acciones</th>
                    </tr>
                </thead>
                <tbody>
                    <% sacos.forEach(saco => { %>
                    <tr class="border-b hover:bg-emerald-50 transition">
                        <td class="p-4 font-mono font-bold text-emerald-700 text-sm"><%= saco.codigoSaco %></td>
                        <td class="p-4 font-semibold text-gray-700"><%= saco.tipoProducto %></td>
                        <td class="p-4 text-center font-bold text-emerald-600"><%= saco.cantidadDisponible %></td>
                        <td class="p-4 text-center text-gray-500"><%= saco.pesoNetoKg %>kg</td>
                        <td class="p-4 text-gray-600 text-sm"><%= saco.ubicacion %></td>
                        <td class="p-4 text-center">
                            <a href="/sacos/<%= saco._id %>" class="text-blue-600 font-bold mr-3">Editar</a>
                            <a href="/sacos/delete/<%= saco._id %>" class="text-red-500 font-bold" onclick="return confirm('¬øEliminar?')">Borrar</a>
                        </td>
                    </tr>
                    <% }) %>
                </tbody>
            </table>
        </div>
    </div>

    <script>
        const mapeoCodigos = {
            "Ma√≠z Amarillo": "LOTE-MA-2026",
            "Arroz Blanco": "LOTE-ARZ-2026",
            "Sorg√≥": "LOTE-SRG-2026",
            "Girasol": "LOTE-GIR-2026",
            "Soya": "LOTE-SOY-2026",
            "Frijol": "LOTE-FRJ-2026",
            "Caraota": "LOTE-CAR-2026",
            "Caf√©": "LOTE-CAF-2026",
            "Cacao": "LOTE-CAC-2026",
            "Trigo": "LOTE-TRI-2026"
        };
        const sel = document.getElementById('selectProducto');
        const cod = document.getElementById('inputCodigo');
        sel.addEventListener('change', () => { cod.value = mapeoCodigos[sel.value] || ""; });
    </script>
</body>
</html>